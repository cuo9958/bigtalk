<!DOCTYPE html>
<html>
<head>
    <title>socket.io 聊天室例子</title>
    <meta charset="utf-8">
    <style type="text/css">
      html,body{
        margin: 0;
        padding: 0;
      }
      
    </style>
</head>
<body>
   
    <script type="text/javascript" src="js/socket.io.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/16.3.5/Tween.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.4.3/pixi.min.js"></script>
    <script type="text/javascript">
          var winWidth,winHeight;
          // 获取窗口宽度
          if (window.innerWidth)
          winWidth = window.innerWidth;
          else if ((document.body) && (document.body.clientWidth))
          winWidth = document.body.clientWidth;
          // 获取窗口高度
          if (window.innerHeight)
          winHeight = window.innerHeight;
          else if ((document.body) && (document.body.clientHeight))
          winHeight = document.body.clientHeight;
          var renderer = PIXI.autoDetectRenderer(winWidth, winHeight);
          document.body.appendChild(renderer.view);
          var stage = new PIXI.Container();
          
          renderer.view.style.float = "left";

          //加载
          PIXI.loader
          .add("images/my.jpg")
          .on("progress", loadProgressHandler)
          .load(setup);
          function loadProgressHandler(loader,resource){
            console.log("loading: " + resource.url); 
            console.log("progress: " + loader.progress + "%"); 
          }

          var sprite;
          function setup() {
            //This code will run when the loader has finished loading the image
            console.log("下载完成");
              sprite = new PIXI.Sprite(
                PIXI.loader.resources["images/my.jpg"].texture
              );
              sprite.width=50;
              sprite.height=50;

             stage.addChild(sprite);
             renderer.render(stage);
              var message = new  PIXI.Text(
                "Hello Pixi!",
                {fontFamily: "Arial", fontSize: 32, fill: "white"}
              );
              message.x=54;
              message.y=96;
              
              stage.addChild(message);

          }

   

          function gameLoop() {

            //Loop this function at 60 frames per second
            requestAnimationFrame(gameLoop);

            //Render the stage to see the animation
            renderer.render(stage);
          }

        //Start the game loop
        gameLoop();

          var ws;
          //var ws = io.connect('http://127.0.0.1:8888');
          var sendMsg = function(msg){
              ws.emit('send.message', msg);
          }
          var addMessage = function(from, msg){
          }

          var send = function(){
              sendMsg(msg);
              // 添加消息到自己的内容区
              addMessage('你', msg);
          }

          ws.on('connect', function(){
              //ws.emit('join', nickname);
          });

          // 昵称有重复
          ws.on('nickname', function(){
              //ws.emit('join', nickname);
          });

          ws.on('send.message', function(from, msg){
              addMessage(from, msg);
          });

          ws.on('announcement', function(from, msg){
              addMessage(from, msg);
          });

    </script>
</body>
</html>